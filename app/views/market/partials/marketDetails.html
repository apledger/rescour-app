<div class="container-fluid" ng-controller="DetailsController">
<div class="row-fluid">
<div class="page-header clearfix">
    <button class="btn pull-right" ng-click="close()"><i class="icon-arrow-left"></i>&nbsp;Back to map</button>
    <h2>{{current.title}}</h2>
    <h4>{{current.getAddress()}}</h4>
</div>
<div class="span12">
<div tabs>
<div pane class="container-fluid" heading="{{panes[0].heading}}" active="panes[0].active">
    <div class="row-fluid">
        <div class="span12">

            <table class="table table-bordered">
                <tbody>
                <tr>
                    <td>
                        <strong>Property Status</strong>
                    </td>
                    <td>
                        {{current.getAttribute("Property Status")}}
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Broker</strong>
                    </td>
                    <td>
                        {{current.getAttribute("Broker")}}
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Year Built</strong>
                    </td>
                    <td>
                        {{current.getAttribute("Year Built")}}
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Number of Units</strong>
                    </td>
                    <td>
                        {{current.getAttribute("Number of Units")}}
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Call for Offers</strong>
                    </td>
                    <td>
                        {{current.details.callForOffers | date}}
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Property Type</strong>
                    </td>
                    <td>
                        {{current.getAttribute('Property Type')}}
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Flyer</strong>
                    </td>
                    <td>
                        <a ng-show="current.details.flyer" target="_blank" ng-href="{{current.details.flyer}}">View</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span12">
            <div class="page-header">
            </div>
            <p class="lead">Description</p>

            <p>{{current.description}}</p>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span12" ng-show="current.details.unitMix">
            <div class="page-header"></div>
            <p class="lead">Property Unit Mix</p>
            <table class="table table-condensed table-striped">
                <thead>
                <tr>
                    <th>Type</th>
                    <th>Units</th>
                    <th>SF</th>
                    <th>Rent</th>
                    <th>Rent / SF</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="mix in current.details.unitMix">
                    <td>
                        {{mix.type}}
                    </td>
                    <td>
                        {{mix.units}}
                    </td>
                    <td>
                        {{mix.sqft}} ft&sup2;
                    </td>
                    <td>
                        {{mix.rent && (mix.rent | currency) || ""}}
                        <!--{{mix.rent | currency}}-->
                    </td>
                    <td>
                        {{mix.rentpsqft}}
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span4" ng-show="current.details.tourDates">
            <div class="page-header">
            </div>
            <p class="lead">Tour Dates</p>
            <table class="table table-condensed table-striped">
                <thead>
                <tr>
                    <th>Date</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="tourDate in current.details.tourDates">
                    <td>
                        {{tourDate.date | date}}
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div pane class="container-fluid picture-container" heading="{{panes[1].heading}}" active="panes[1].active">
    <div class="row-fluid">
        <div class="span8 offset2" ng-show="current.getImages().length > 0">
            <div carousel no-transition="true">
                <div slide ng-repeat="slide in current.getImages()" active="slide.active">
                    <img ng-src="{{slide.link}}" style="margin:auto;">

                    <div class="counter">{{$index + 1}} of {{current.getImages().length}}</div>
                </div>
            </div>
        </div>
        <div class="span8 alert alert-info" ng-show="current.getImages().length == 0">
            <strong>Sorry!</strong> We don't have any images for this listing.
        </div>
    </div>
</div>

<div pane class="container-fluid" heading="{{panes[2].heading}}" active="panes[2].active">
    <div alert type="alert.type" fade-after="2000" ng-repeat="alert in contactAlerts">{{alert.msg}}</div>
    <form class="contact-form" ng-show="current.details.contacts.length > 0">
        <div class="control-group">
            <div class="control-label">To:</div>
            <div class="controls">
                <label class="checkbox" ng-class="{'contact-selected': contact.selected}"
                       ng-repeat="contact in current.details.contacts">
                    <input type="checkbox" ng-model="contact.selected">
                    <strong>{{contact.name}}</strong> - {{contact.phone}} - <em>{{contact.email}}</em>
                </label>
            </div>
        </div>
        <div class="control-group">
            <div class="control-label">Message:</div>
            <div class="controls">
                <textarea rows="6" class="span10" ng-model="newEmail.message"></textarea>
            </div>
        </div>
        <button class="btn btn-info" ng-click="sendEmail(newEmail)">Send</button>
    </form>
    <div class="alert" ng-show="!current.details.contacts || current.details.contacts.length == 0"><strong>Sorry!</strong> We don't
        have any contacts for this listing.
    </div>
</div>

<div pane class="container-fluid" heading="{{panes[3].heading}}" active="panes[3].active">
    <div ng-repeat="comment in current.details.comments">
        <div class="alert alert-info comment-alert">
            <h5>{{comment.userEmail}} <span>{{comment.timestamp | date}}</span></h5>

            <p>{{comment.text}}</p>
        </div>
    </div>
    <form name="formNewComment" novalidate>
        <div class="control-group">
            <div class="control-label">Comment:</div>
            <div class="controls">
                <textarea rows="6" name="text" class="span12" required ng-model="newComment.text"></textarea>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-success" ng-click="addComment(newComment)">
                Add Comment
            </button>
            <button type="button" class="btn" ng-click="close()">Cancel</button>
        </div>
    </form>
</div>

<div pane class="container-fluid finance-container" heading="{{panes[4].heading}}" active="panes[4].active">
    <div class="row-fluid">
        <div class="span12">
            <form novalidate class="form-horizontal">
                <legend></legend>
                <div class="control-group" ng-repeat="finance in current.details.finances">
                    <a href="javascript:" class="finance-delete" ng-click="deleteFinance(finance)">
                        <i class="icon-remove-sign"></i>
                    </a>
                    <div class="control-label">
                        <input placeholder="Click to edit" name="name"
                               class="edit-label"
                               type="text" ng-model="finance.name"
                               typeahead-select="field for field in financeFields | filter:$viewValue">
                        <i class="icon-pencil"></i>

                    </div>

                    <div class="controls">
                        <input placeholder="Value" type="text" format-input="{{finance.valueFormat}}" name="value"
                               ng-blur="saveFinance(finance)" ng-model="finance.value"
                               class="input-small">
                        <select ng-options="format.valueFormat as format.icon for format in valueFormats"
                                class="finance-class"
                                ng-model="finance.valueFormat" ng-change="saveFinance(finance)"></select>
                    </div>
                </div>
                <div class="form-actions">
                    <a href="javascript:" class="btn btn-success" ng-click="addFinance()">Add Finance Note</a>
                </div>
            </form>
        </div>
    </div>
</div>
</div>
</div>
</div>
</div>
